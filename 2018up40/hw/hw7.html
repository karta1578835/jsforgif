<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <title>Homework05</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta name="robots" content="noindex, nofollow">
  <meta name="googlebot" content="noindex, nofollow">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <style type="text/css">
    #info {
		position: absolute;
		top: 0px;
		width: 100%;
		padding: 10px;
		text-align: center;
		color: #ffff00
	}

	body {
		overflow: hidden;
	}
  </style>
</head>
<body>
  <div id="info">
    HW5 dance<br>
	<button id="start" style="width:10%" value = 'switch'>stop</button>
  </div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/94/three.min.js"></script>
<script src="https://threejs.org/examples/js/controls/OrbitControls.js"></script>
<script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="https://jyunming-chen.github.io/tutsplus/js/KeyboardState.js"></script>

<script>

///////////////////////////////////////////////////////////////////////
var camera, scene, renderer;
var angle,angle1,angle2,move1;
var a5x,a5y,a5z;
var amr,amr1,amr2,amr3,amr4,amr5,amr6;
var keyboard = new KeyboardState();
var runs;
var tt=0;

init();
animate();

$("#start").click(function() {	
	if(runs){ // is turning
		$('#start').text('stop');
    tt=0;
  }
	else{
		$('#start').text('turn');	
    tt=1;
  }
  runs = !runs;
});

function makeArm (r1, r2, a, d) {
	let x1 = (r1*r1-r1*r2)/a
  let y1 = (r1*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  let x2 = (-r2*r2+r1*r2+a*a)/a
  let y2 = (r2*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  
	let armShape = new THREE.Shape();
  armShape.moveTo (x1,y1)
  armShape.absarc (0,0,r1,Math.atan2(y1,x1),Math.atan2(-y1,x1))
  armShape.lineTo (x2,-y2)
  armShape.absarc (a,0,r2,Math.atan2(-y2,x2-a),Math.atan2(y2,x2-a))  
  armShape.lineTo (x1,y1)
  
  let extrudeSettings = {
    steps: 200,
    depth: d,
    bevelEnabled: false,
  };
  let geometry = new THREE.ExtrudeGeometry(armShape, extrudeSettings);	
  let mesh = new THREE.Mesh(geometry, aa);
	return mesh
}
function makeArm6 (r1, r2, a, d) {
	let x1 = (r1*r1-r1*r2)/a
  let y1 = (r1*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  let x2 = (-r2*r2+r1*r2+a*a)/a
  let y2 = (r2*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  
	let armShape = new THREE.Shape();
  armShape.moveTo (x1,y1)
  armShape.absarc (0,0,r1,Math.atan2(y1,x1),Math.atan2(-y1,x1))
  armShape.lineTo (x2,-y2)
  armShape.absarc (a,0,r2,Math.atan2(-y2,x2-a),Math.atan2(y2,x2-a))  
  armShape.lineTo (x1,y1)
  
  let extrudeSettings = {
    steps: 200,
    depth: d,
    bevelEnabled: false,
  };
  let geometry = new THREE.ExtrudeGeometry(armShape, extrudeSettings);	
  let mesh = new THREE.Mesh(geometry, a6);
	return mesh
}
function makeArm1 (r1, r2, a, d) {
	let x1 = (r1*r1-r1*r2)/a
  let y1 = (r1*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  let x2 = (-r2*r2+r1*r2+a*a)/a
  let y2 = (r2*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  
	let armShape = new THREE.Shape();
  armShape.moveTo (x1,y1)
  armShape.absarc (0,0,r1,Math.atan2(y1,x1),Math.atan2(-y1,x1))
  armShape.lineTo (x2,-y2)
  armShape.absarc (a,0,r2,Math.atan2(-y2,x2-a),Math.atan2(y2,x2-a))  
  armShape.lineTo (x1,y1)
  
  let extrudeSettings = {
    steps: 200,
    depth: d,
    bevelEnabled: false,
  };
  let geometry = new THREE.ExtrudeGeometry(armShape, extrudeSettings);	
  let mesh = new THREE.Mesh(geometry, a1);
	return mesh
}
function makeArm2 (r1, r2, a, d) {
	let x1 = (r1*r1-r1*r2)/a
  let y1 = (r1*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  let x2 = (-r2*r2+r1*r2+a*a)/a
  let y2 = (r2*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  
	let armShape = new THREE.Shape();
  armShape.moveTo (x1,y1)
  armShape.absarc (0,0,r1,Math.atan2(y1,x1),Math.atan2(-y1,x1))
  armShape.lineTo (x2,-y2)
  armShape.absarc (a,0,r2,Math.atan2(-y2,x2-a),Math.atan2(y2,x2-a))  
  armShape.lineTo (x1,y1)
  
  let extrudeSettings = {
    steps: 200,
    depth: d,
    bevelEnabled: false,
  };
  let geometry = new THREE.ExtrudeGeometry(armShape, extrudeSettings);	
  let mesh = new THREE.Mesh(geometry, a2);
	return mesh
}
function makeArm3 (r1, r2, a, d) {
	let x1 = (r1*r1-r1*r2)/a
  let y1 = (r1*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  let x2 = (-r2*r2+r1*r2+a*a)/a
  let y2 = (r2*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  
	let armShape = new THREE.Shape();
  armShape.moveTo (x1,y1)
  armShape.absarc (0,0,r1,Math.atan2(y1,x1),Math.atan2(-y1,x1))
  armShape.lineTo (x2,-y2)
  armShape.absarc (a,0,r2,Math.atan2(-y2,x2-a),Math.atan2(y2,x2-a))  
  armShape.lineTo (x1,y1)
  
  let extrudeSettings = {
    steps: 200,
    depth: d,
    bevelEnabled: false,
  };
  let geometry = new THREE.ExtrudeGeometry(armShape, extrudeSettings);	
  let mesh = new THREE.Mesh(geometry, a3);
	return mesh
}
function makeArm4 (r1, r2, a, d) {
	let x1 = (r1*r1-r1*r2)/a
  let y1 = (r1*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  let x2 = (-r2*r2+r1*r2+a*a)/a
  let y2 = (r2*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  
	let armShape = new THREE.Shape();
  armShape.moveTo (x1,y1)
  armShape.absarc (0,0,r1,Math.atan2(y1,x1),Math.atan2(-y1,x1))
  armShape.lineTo (x2,-y2)
  armShape.absarc (a,0,r2,Math.atan2(-y2,x2-a),Math.atan2(y2,x2-a))  
  armShape.lineTo (x1,y1)
  
  let extrudeSettings = {
    steps: 200,
    depth: d,
    bevelEnabled: false,
  };
  let geometry = new THREE.ExtrudeGeometry(armShape, extrudeSettings);	
  let mesh = new THREE.Mesh(geometry, a4);
	return mesh
}
function makeArm5 (r1, r2, a, d) {
	let x1 = (r1*r1-r1*r2)/a
  let y1 = (r1*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  let x2 = (-r2*r2+r1*r2+a*a)/a
  let y2 = (r2*Math.sqrt(-r2*r2+2*r1*r2-r1*r1+a*a))/a
  
	let armShape = new THREE.Shape();
  armShape.moveTo (x1,y1)
  armShape.absarc (0,0,r1,Math.atan2(y1,x1),Math.atan2(-y1,x1))
  armShape.lineTo (x2,-y2)
  armShape.absarc (a,0,r2,Math.atan2(-y2,x2-a),Math.atan2(y2,x2-a))  
  armShape.lineTo (x1,y1)
  
  let extrudeSettings = {
    steps: 200,
    depth: d,
    bevelEnabled: false,
  };
  let geometry = new THREE.ExtrudeGeometry(armShape, extrudeSettings);	
  let mesh = new THREE.Mesh(geometry, a5);
	return mesh
}


function init() {

	scene = new THREE.Scene();

  camera = new THREE.PerspectiveCamera(50, window.innerWidth / window.innerHeight, 1, 1000);
  camera.position.z = 500;
  scene.add(camera);

  var gridXZ = new THREE.GridHelper(200, 20, 'red', 'white');
  scene.add(gridXZ);

  renderer = new THREE.WebGLRenderer();
  renderer.setSize(window.innerWidth, window.innerHeight);
  renderer.setClearColor(0x888888);

  let controls = new THREE.OrbitControls(camera, renderer.domElement);

  document.body.appendChild(renderer.domElement);
  ////////////////////////////////////////////////////////////////////////
    THREE.ImageUtils.crossOrigin = '';
    a6 = new THREE.MeshBasicMaterial({
        side: THREE.DoubleSide,
        transparent: true, // key to cutout texture
        map: THREE.ImageUtils.loadTexture('https://i.imgur.com/C0LpXuP.jpg')
    });
    
    THREE.ImageUtils.crossOrigin = '';
    aa = new THREE.MeshBasicMaterial({
        side: THREE.DoubleSide,
        transparent: true, // key to cutout texture
        map: THREE.ImageUtils.loadTexture('https://i.imgur.com/mjWGRUp.jpg')
    });
    THREE.ImageUtils.crossOrigin = '';
    a1 = new THREE.MeshBasicMaterial({
        side: THREE.DoubleSide,
        transparent: true, // key to cutout texture
        map: THREE.ImageUtils.loadTexture('https://i.imgur.com/9WX8T03.jpg')
    });
    THREE.ImageUtils.crossOrigin = '';
    a2 = new THREE.MeshBasicMaterial({
        side: THREE.DoubleSide,
        transparent: true, // key to cutout texture
        map: THREE.ImageUtils.loadTexture('https://i.imgur.com/qfXqQSD.jpg')
    });
    THREE.ImageUtils.crossOrigin = '';
    a3 = new THREE.MeshBasicMaterial({
        side: THREE.DoubleSide,
        transparent: true, // key to cutout texture
        map: THREE.ImageUtils.loadTexture('https://i.imgur.com/riXQIcK.jpg')
    });
    THREE.ImageUtils.crossOrigin = '';
    a4 = new THREE.MeshBasicMaterial({
        side: THREE.DoubleSide,
        transparent: true, // key to cutout texture
        map: THREE.ImageUtils.loadTexture('https://i.imgur.com/LZnwPHv.png')
    });
    THREE.ImageUtils.crossOrigin = '';
    a5 = new THREE.MeshBasicMaterial({
        side: THREE.DoubleSide,
        transparent: true, // key to cutout texture
        map: THREE.ImageUtils.loadTexture('https://i.imgur.com/AvD3b7X.jpg')
    });
  /////////////////////////////////////////////////////////////////////

	big7 = new THREE.Group();
  
  arm = makeArm5 (28,1, 0, 5)// 圓.尖或長方,尖的長,厚度
  arm.position.set(0,5,0);
  arm.rotation.x=Math.PI/2;
  //arm.position.y = -1
  scene.add (arm)
  //big7.add (arm);
  
  arm1 = makeArm1 (8,1, 0, 40)
  arm1.position.set(0,0,-40);
  //arm1.rotation.x=Math.PI/2;
  scene.add (arm1) 
  //big7.add (arm1);
 
  arm2 = makeArm2 (6,1, 0, 60)
  arm2.position.set(0,40,-6);
  arm2.rotation.x=Math.PI/2;
  scene.add (arm2)
  //big7.add (arm2);
  
  arm3 = makeArm3 (12,7, 35, 5)
  arm3.position.set(0,0,-5);
  scene.add (arm3)  
  //big7.add (arm3);
  
  arm4 = makeArm4 (8,6, 26, 5)
  arm4.position.set(30,0,5);
  scene.add (arm4)
  //big7.add (arm4);
  
  arm5 = makeArm (3,1, 3, 5)
  arm5.position.set(33,0,0);
  scene.add (arm5) 
  //big7.add (arm5);
  
  arm6 = makeArm6 (5,1,0,10)
  arm6.position.set(-17,0,-10);
  //arm6.rotation.x=Math.PI/2;
  scene.add (arm6) 
  //big7.add (arm6);
  
  arm.add (arm6);
  arm.add (arm1);
  arm1.add (arm2);
  arm2.add (arm3);
  arm3.add (arm4);
  arm4.add (arm5);
  
  
  //scene.add ( big7);
  angle = 0;
  angle1 = 0;
  angle2 = 0;
  move1 = 0;

}

function animate() {

  keyboard.update();
  if (keyboard.pressed ('A')) {
  	if(move1<=12) move1 = move1 + 0.1;    
  } else if (keyboard.pressed ('D')) {
    if(move1>=-7) move1 = move1 - 0.1;
  } else if (keyboard.pressed ('W')) {
    if(angle1>=-0.7) angle1 = angle1 - 0.1;  
  } else if (keyboard.pressed ('S')) {
    if(angle1<=0.7) angle1 = angle1 + 0.1;    
  } else if (keyboard.pressed ('J')) {
    if(angle2>=-0.7) angle2 = angle2 - 0.1
  } else if (keyboard.pressed ('K')) {
    if(angle2<=0.7) angle2 = angle2 + 0.1;
  } 
  if(tt===0) angle = angle + 0.01; 
  arm1.rotation.z = angle ;  //+ Math.PI/2
  arm2.position.y = 40 + move1 ;  
  arm2.rotation.z = angle1;
  arm4.rotation.z = angle2;
  
  requestAnimationFrame(animate);
  render();
}

function render() {
  renderer.render(scene, camera);
}

</script>
  <script>
    // tell the embed parent frame the height of the content
    if (window.parent && window.parent.parent){
      window.parent.parent.postMessage(["resultsFrame", {
        height: document.body.getBoundingClientRect().height,
        slug: ""
      }], "*")
    }
  </script>
</body>
</html>
